# -EndIf-Sleep-10-
Func _WD_NewTab($sSession, $lSwitch = True)     Local Const $sFuncName = "_WD_NewTab"     Local $sTabHandle = ''     Local $TimerNewTab = 0     _WD_ExecuteScript($sSession, 'window.open()', '{}')     $TimerNewTab = TimerInit()      While 1         If TimerDiff($TimerNewTab) > 5000 Then Return SetError($_WD_ERROR_Success, 0, $sTabHandle)         If @error = $_WD_ERROR_Success Then             Local $aHandles = _WD_Window($sSession, 'handles', '')             $sTabHandle = $aHandles[UBound($aHandles) - 1]             If $lSwitch Then                 _WD_Window($sSession, 'Switch', '{"handle":"' &amp; $sTabHandle &amp; '"}')             EndIf             ExitLoop         EndIf         Sleep(10)     WEnd     Return SetError($_WD_ERROR_Success, 0, $sTabHandle) EndFunc   ;==>_WD_NewTab
